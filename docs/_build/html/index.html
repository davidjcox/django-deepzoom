

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Django-deepzoom documentation &mdash; Django-deepzoom 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Django-deepzoom 0.2 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">Django-deepzoom 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="django-deepzoom-documentation">
<h1><a class="toc-backref" href="#id1">Django-deepzoom documentation</a><a class="headerlink" href="#django-deepzoom-documentation" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#django-deepzoom-documentation" id="id1">Django-deepzoom documentation</a><ul>
<li><a class="reference internal" href="#what-is-django-deepzoom" id="id2">What is Django-deepzoom?</a></li>
<li><a class="reference internal" href="#how-do-i-install-it" id="id3">How do I install it?</a></li>
<li><a class="reference internal" href="#how-do-i-configure-it" id="id4">How do I configure it?</a></li>
<li><a class="reference internal" href="#how-is-it-licensed" id="id5">How is it licensed?</a></li>
<li><a class="reference internal" href="#how-can-i-leave-feedback" id="id6">How can I leave feedback?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#search" id="id7">Search</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="section" id="what-is-django-deepzoom">
<h2><a class="toc-backref" href="#id2">What is Django-deepzoom?</a><a class="headerlink" href="#what-is-django-deepzoom" title="Permalink to this headline">¶</a></h2>
<p>Django-deepzoom is a drop-in Django app for the creation and use of Deep Zoom
tiled images.  It handily integrates Daniel Gasienica&#8217;s and Kapil Thangavelu&#8217;s
deepzoom.py image generator, Microsoft&#8217;s SeaDragon deep zoom viewer, and
Sean Rice&#8217;s JavaScript touch events into a set of model classes and template
tags which programmatically generate tiled images and all JavaScript necessary
for their instantiation into templates.</p>
<p>The purpose of Django-deepzoom is to make the integration of the deepzoom tiled
image viewer into Django projects as easy as possible.  Previously that required
importing the standalone deepzoom module into your project, writing custom model
class code to generate tiled images from it, and crafting custom JavaScript
markup in your templates to instantiate it.  Whew!</p>
<p>Django-deepzoom handles this all for you.  The app consists of two model classes
and a template tag that orchestrate image uploads, deepzoom generation, deepzoom
file saves/deletes to the filesystem, and template JavaScript markup.</p>
<p>The classes consist of an abstract image upload class and a standard deepzoom
generator class.</p>
<p>The image upload class is just as it&#8217;s named: a class that handles an image
upload, names it, and generates a slug for it.  However, it also provides a
checkbox in the admin to request the generation of a deep zoom image from the
uploaded image.  Because the class is abstract and generates deep zooms
conditionally, it can be inherited and extended for use by any class that
incorporates uploaded images.</p>
<p>UploadedImage class:</p>
<ul class="simple">
<li>abstract class</li>
<li>ImageField for uploaded image files</li>
<li>saves unique image name</li>
<li>saves unique image slug from image name</li>
<li>saves image height, width</li>
<li>configurable image file save location</li>
<li>optional deep zoom generation</li>
<li>image file deletion on delete</li>
</ul>
<p>The standard deepzoom class handles deepzoom generation and file management.
It receives a reference to the uploaded image from the image upload class,
generates a deep zoom image from it, names and slugifies it identically to the
uploaded image, extracts the XML signature needed to instantiate the deepzoom
viewer, saves the XML needed to instantiate the deepzoom viewer, and saves the
generated file hierarchy to the filesystem.  It does not allow editing of
existing deepzooms, but it does allow for deletion and re-generation, because
it handles file hierarchy deletion from the filesystem on delete.</p>
<p>DeepZoom class:</p>
<ul class="simple">
<li>standard class</li>
<li>generates deep zoom tiled image</li>
<li>saves unique deepzoom image name (named identically to associated image)</li>
<li>saves unique deepzoom image slug (slugified identically to associated image)</li>
<li>saves file path of associated image</li>
<li>saves deepzoom image path (part after MEDIA_ROOT)</li>
<li>saves full deepzoom image path</li>
<li>saves XML needed by deep zoom viewer</li>
</ul>
<p>The django-deepzoom template tag takes a deepzoom object and a div id and
outputs the full JavaScript needed to instantiate the specified deepzoom object
in the deepzoom viewer within the specified div and enable touch gestures for
it.  Since it&#8217;s a custom template tag, it needs to be loaded somewhere before
its usage in the template by calling {% load deepzoom_tags %}.  Since it outputs
JavaScript only and not HTML, the deepzoom template tag needs to be embedded
within &lt;script&gt; tags.</p>
<p>DeepZoom template tag usage:</p>
<div class="highlight-python"><pre>{% load deepzoom_tags %}
&lt;div id="deepzoom_div"&gt;&lt;/div&gt;
&lt;script&gt;
{% deepzoom_js deepzoom_obj "deepzoom_div" %}
&lt;/script&gt;</pre>
</div>
<p>Neither the deep zoom queryset object nor the deep zoom div ID have to be named
like in the example.  Any name can be given to either, so long as the deep zoom
queryset object is named the same way in the template as it is in the view
providing it and the deep zoom div ID matches the name is passed deepzoom_js
template tag.  Further, the deep zoom div is just the container for the deep
zoom viewer, so it can be used any way that divs can, including as a floated
element, a modal dialog, etc.  Knock yourself out.</p>
</div>
<div class="section" id="how-do-i-install-it">
<h2><a class="toc-backref" href="#id3">How do I install it?</a><a class="headerlink" href="#how-do-i-install-it" title="Permalink to this headline">¶</a></h2>
<p>1.) Install &#8220;django-deepzoom&#8221; like this:</p>
<div class="highlight-python"><pre>pip install -U django-deepzoom</pre>
</div>
<p>or, like this:</p>
<div class="highlight-python"><pre>wget https://pypi.python.org/packages/source/d/django-deepzoom/django-deepzoom-&lt;VERSION&gt;.tar.gz
tar -xvf django-deepzoom-0.1.tar.gz
cd django-deepzoom-0.1
python setup.py install</pre>
</div>
<p>If you download it directly, change &lt;VERSION&gt; to one of the available version
numbers, of course.  Installing to a
<a class="reference external" href="https://pypi.python.org/pypi/virtualenv">virtualenv</a> is a good idea, too.</p>
<p>2.) Add &#8220;deepzoom&#8221; to your INSTALLED_APPS setting like this:</p>
<div class="highlight-python"><pre>(in settings.py)

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django.contrib.admin',
    ...
    'deepzoom',
    ...
)</pre>
</div>
<p>The Django apps shown are for demonstration only&#8211; django-deepzoom has no
dependencies on them.</p>
<p>3.) Sub-class the &#8216;<cite>UploadedImage</cite>&#8216; model class as your own (image-based) class, something like this:</p>
<div class="highlight-python"><pre>(in models.py)

from deepzoom.models import DeepZoom, UploadedImage

class MyImage(UploadedImage):
  '''
  Overrides UploadedImage base class.
  '''
  pass</pre>
</div>
<p>The save() method of the overridden class can be overridden, too, of course, to
add additional fields or features.</p>
<p>4.) Run <cite>python manage.py syncdb</cite> to create the django-deepzoom models.</p>
<p>5.) Add an appropriate URL to your Urlconf, something like this:</p>
<div class="highlight-python"><pre>(in urls.py)

from deepzoom.views import deepzoom_view

urlpatterns = patterns('',
    ...
    url(r'^deepzoom/(?P&lt;passed_slug&gt;\b[a-z0-9\-]+\b)',
        deepzoom_view,
        name="v_deepzoom"),
    ...
)</pre>
</div>
<p>The slug parameter name does not have to be the same as the example as long as
it matches the corresponding view. (See below)</p>
<p>6.) Write a view that queries for a specific DeepZoom object and passes it to a template, something like this:</p>
<div class="highlight-python"><pre>(in views.py)

from deepzoom.models import DeepZoom

def deepzoom_view(request, passed_slug=None):
  try:
      _deepzoom_obj = DeepZoom.objects.get(slug=passed_slug)
  except DeepZoom.DoesNotExist:
      raise Http404
  return render_to_response('deepzoom.html',
                            {'deepzoom_obj': _deepzoom_obj},
                            context_instance=RequestContext(request))</pre>
</div>
<p>The slug parameter name does not have to be the same as the example as long as
it matches the corresponding urlconf signature.  (See above)</p>
<p>7.) In your template, create an empty div with a unique ID.  Load the deepzoom
tags and pass the deepzoom object and deepzoom div ID to the template tag inside
a &lt;script&gt; block in the body like this:</p>
<div class="highlight-python"><pre>(in e.g. deepzoom.html)

{% extends "base.html" %}

{% load deepzoom_tags %}

&lt;div id="deepzoom_div"&gt;&lt;/div&gt;

&lt;script src="{{ STATIC_URL }}js/vendor/seadragon-min.js"&gt;&lt;/script&gt;

&lt;script&gt;{% deepzoom_js deepzoom_obj "deepzoom_div" %}&lt;/script&gt;</pre>
</div>
<p>Neither the deep zoom queryset object nor the deep zoom div ID have to be named
like in the example.  Any name can be given to either, so long as the deep zoom
queryset object is named the same way in the template as it is in the view
providing it and the deep zoom div ID matches the name is passed deepzoom_js
template tag.</p>
<p>8.) Run <cite>python manage.py collectstatic</cite> to collect your static files into
STATIC_ROOT, specifically so that the seadragon-min.js file is available.</p>
<p>9.) Start the development server and visit <cite>http://127.0.0.1:8000/admin/</cite> to
upload an image to the associated model (you&#8217;ll need the Admin app enabled).
Be sure to check the <cite>Generate deep zoom?</cite> checkbox for that image before
saving it.</p>
</div>
<div class="section" id="how-do-i-configure-it">
<h2><a class="toc-backref" href="#id4">How do I configure it?</a><a class="headerlink" href="#how-do-i-configure-it" title="Permalink to this headline">¶</a></h2>
<p>Django-deepzoom does not require configuration to work.  It assumes a sensible
default configuration that should work for anyone.  However, should you wish to
customize its behavior, the following can be configured in your settings.py file.</p>
<p><strong>UPLOADEDIMAGE_ROOT</strong></p>
<p>A string defining the directory to be appended to MEDIA_ROOT for storing
uploaded images.  Do not include beginning or trailing directory separators.
If defined, but not actually created, your directory will be created for you.
If left undefined, &#8216;uploaded_images&#8217; is used as the default directory name.</p>
<p>E.g. after prepending your media root, the default UPLOADEDIMAGE_ROOT is
&#8216;/path/to/media_root/uploaded_images/&#8217;</p>
<p>Or, if you define <tt class="docutils literal"><span class="pre">UPLOADEDIMAGE_ROOT='my/uploaded/images'</span></tt>, the final path will
be &#8216;/path/to/media_root/my/uploaded/images/&#8217;</p>
<p><strong>DEEPZOOM_PARAMS</strong></p>
<p>This is a list of arguments used to initialize the deep zoom creator, including
&#8216;tile_size&#8217;, &#8216;tile_overlap&#8217;, &#8216;tile_format&#8217;, &#8216;image_quality&#8217;, and &#8216;resize_filter&#8217;
in order.
If undefined, <tt class="docutils literal"><span class="pre">[256,</span> <span class="pre">1,</span> <span class="pre">&quot;jpg&quot;,</span> <span class="pre">0.85,</span> <span class="pre">&quot;antialias&quot;]</span></tt> is used by default.</p>
<dl class="docutils">
<dt><em>tile_size</em></dt>
<dd><p class="first">type: int
options: 1 to maxint
default: 256</p>
<p class="last">The tile_size defines the size of tiles that each image on a pyramid level
will be subdivided into and re-sized for the next pyramid level.  The
smaller the size, the deeper the overall zoom.  However, as the tile size
approaches one, the number of tiles per level increases to the limit of
pixels of the largest side of the original image overtaxing file IO and
server bandwidth per page request.  Conversely, as the tile size approaches
the number of pixels of the largest side of the original image,
the number of tiles approaches one, eliminating the zoom effect completely.
The most useful range is roughly 1/10 - 1/4 the size of the largest side of
the original image.</p>
</dd>
<dt><em>tile_overlap</em></dt>
<dd><p class="first">type: int
options: 0 to 10
default: 1</p>
<p class="last">The tile_overlap defines the number of pixels a tile overlaps its
neighboring tiles on each pyramid level.  As tile overlap is decreased, the
total number of tiles generated potentially reduces, and as tile overlap is
increased, the total number of tiles generated potentially increases.  If
set to zero, gapping between tiles may be visible when zoomed.</p>
</dd>
<dt><em>tile_format</em></dt>
<dd><p class="first">type: str
options: &#8216;jpg&#8217; or &#8216;png&#8217;
default: &#8216;jpg&#8217;</p>
<p class="last">The tile_format determines the final image type of the generated tiled
images.  The usual image format considerations apply.  Generally, JPEG is
better suited for photographs and realistic images, whereas PNG is better
suited for line drawings or text.  If file size and bandwidth is not a
concern, PNG will be superior because it is a lossless compression format.</p>
</dd>
<dt><cite>resize_filter</cite></dt>
<dd><p class="first">type: str
options: &#8216;cubic&#8217;, &#8216;bilinear&#8217;, &#8216;bicubic&#8217;, &#8216;nearest&#8217;, or &#8216;antialias&#8217;
default: &#8216;antialias&#8217;</p>
<p class="last">The resize_filter is the method used to re-sample images when resizing them
during tile creation.  Different filters are better suited for certain tasks.
The &#8216;antialias&#8217; filter trades off highest quality for slowest speed of
creation.  Since tiled image generation is a one-time expense, it&#8217;s a
reasonable tradeoff for the default.</p>
</dd>
</dl>
<p><strong>DEEPZOOM_ROOT</strong></p>
<p>A string defining the directory to be appended to MEDIA_ROOT for storing deep
zoom files.  Do not include beginning or trailing directory separators.  If
defined, but not actually created, your directory will be created for you.
If left undefined, &#8216;deepzoom_images&#8217; is used as the default directory name.</p>
<p>E.g. after prepending your media root, the default DEEPZOOM_ROOT is
&#8216;/path/to/media_root/deepzoom_images/&#8217;</p>
<p>Or, if you define <tt class="docutils literal"><span class="pre">DEEPZOOM_ROOT='my/deepzoom/images'</span></tt>, the final path will be
&#8216;/path/to/media_root/my/deepzoom/images/&#8217;</p>
</div>
<div class="section" id="how-is-it-licensed">
<h2><a class="toc-backref" href="#id5">How is it licensed?</a><a class="headerlink" href="#how-is-it-licensed" title="Permalink to this headline">¶</a></h2>
<p>Django-deepzoom is BSD-licensed for full use with attribution to the author.</p>
</div>
<div class="section" id="how-can-i-leave-feedback">
<h2><a class="toc-backref" href="#id6">How can I leave feedback?</a><a class="headerlink" href="#how-can-i-leave-feedback" title="Permalink to this headline">¶</a></h2>
<p>Send questions, suggestions, comments to &lt;<a class="reference external" href="mailto:davidjcox&#46;at&#37;&#52;&#48;gmail&#46;com">davidjcox<span>&#46;</span>at<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;.
Let me know if you&#8217;re successfully using Django-deepzoom for your project.</p>
<p>Build good things.</p>
</div>
</div>
<div class="section" id="search">
<h1><a class="toc-backref" href="#id7">Search</a><a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Django-deepzoom documentation</a><ul>
<li><a class="reference internal" href="#what-is-django-deepzoom">What is Django-deepzoom?</a></li>
<li><a class="reference internal" href="#how-do-i-install-it">How do I install it?</a></li>
<li><a class="reference internal" href="#how-do-i-configure-it">How do I configure it?</a></li>
<li><a class="reference internal" href="#how-is-it-licensed">How is it licensed?</a></li>
<li><a class="reference internal" href="#how-can-i-leave-feedback">How can I leave feedback?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#search">Search</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">Django-deepzoom 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, David J Cox.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>